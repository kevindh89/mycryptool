{% extends 'base.html.twig' %}

{% block body %}
    <div class="alert my-2" role="alert">
        The list of closed orders is not real-time synced with GDAX.
        <a onclick="reloadTradeList();" target="_blank" class="btn btn-dark mx-2">Collect latest closed orders</a>
    </div>

    <div id="trade-list">
        {{ render(controller('App\\Controller\\FrontendController::tradeList')) }}
    </div>
{% endblock %}

{% block javascripts %}
    {{ parent() }}

    <script type="text/javascript">
        function reloadTradeList() {
            var tradeListElement = $('#trade-list');
            tradeListElement.html('<div class="text-center"><i class="fa fa-spinner fa-3x fa-pulse"></i></div>');

            MyCryptool.updateTrades()
                .then(function () {
                    MyCryptool.loadTradeList(tradeListElement);
                });
        }
    </script>
{% endblock %}